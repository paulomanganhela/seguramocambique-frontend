<h1>Formulário de Pedido de Instalação</h1>

<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Pedido de Instalação - SeguraMoçambique</title>
  <link rel="stylesheet" href="style-home.css">
</head>
<body>

<header>
  <div class="logo">SeguraMoçambique</div>
</header>

<section class="contato">
  <h2>Formulário de Pedido de Instalação</h2>
  <form id="formPedido">
    <input type="text" id="nome" placeholder="Nome Completo" required><br>
    <input type="email" id="email" placeholder="Email" required><br>
    <input type="tel" id="telefone" placeholder="Telefone" required><br>

    <select id="tipo_casa" required>
      <option value="">Tipo de Casa</option>
      <option value="Residência">Residência</option>
      <option value="Escritório">Escritório</option>
      <option value="Armazém">Armazém</option>
      <option value="Outro">Outro</option>
    </select><br>

    <input type="number" id="numero_compartimentos" placeholder="Número de Compartimentos" required><br>

    <select id="tipo_camera" required>
      <option value="">Tipo de Câmera</option>
      <option value="Solar 4G">Solar 4G</option>
      <option value="Solar WiFi">Solar WiFi</option>
      <option value="WiFi PoE">WiFi PoE</option>
      <option value="Com Cabo">Com Cabo</option>
      <option value="DVR/NVR">DVR/NVR</option>
    </select><br>

    <select id="armazenamento" required>
      <option value="">Armazenamento</option>
      <option value="64GB">64GB</option>
      <option value="128GB">128GB</option>
      <option value="256GB">256GB</option>
      <option value="512GB">512GB</option>
      <option value="1TB">1TB</option>
      <option value="2TB">2TB</option>
    </select><br>

    <input type="text" id="localizacao" placeholder="Localização (Cidade)" required><br>

    <button type="submit">Enviar Pedido</button>
  </form>
</section>

<script>
function calcularValor(quantidade) {
  return quantidade * 2500;
}

function calcularTransporte(localizacao) {
  if (localizacao.toLowerCase().includes("maputo")) return 1000;
  if (localizacao.toLowerCase().includes("matola")) return 2000;
  if (localizacao.toLowerCase().includes("marracuene")) return 2500;
  return 120 * 10;
}

document.getElementById('formPedido').addEventListener('submit', async function(e) {
  e.preventDefault();

  const quantidade = parseInt(document.getElementById('numero_compartimentos').value) || 0;
  const localizacao = document.getElementById('localizacao').value;

  const payload = {
    nome: document.getElementById('nome').value,
    email: document.getElementById('email').value,
    telefone: document.getElementById('telefone').value,
    tipo_casa: document.getElementById('tipo_casa').value,
    numero_compartimentos: quantidade,
    tipo_camera: document.getElementById('tipo_camera').value,
    armazenamento: document.getElementById('armazenamento').value,
    valor_estimado: calcularValor(quantidade),
    transporte: calcularTransporte(localizacao),
    localizacao: localizacao
  };

  const res = await fetch('https://seguramocambique-backend-1.onrender.com/api/pedidos', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });

  if (res.ok) {
    alert('Pedido recebido com sucesso!');
    document.getElementById('formPedido').reset();
  } else {
    alert('Erro ao enviar pedido. Tente novamente.');
  }
});
</script>

</body>
</html>
"""